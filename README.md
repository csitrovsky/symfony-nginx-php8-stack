# Symfony + Nginx + PHP 8.3 Docker Stack

[![Docker](https://img.shields.io/badge/Docker-3.0%2B-blue)](https://www.docker.com/)
[![PHP](https://img.shields.io/badge/PHP-8.3-purple)](https://www.php.net/)
[![Symfony](https://img.shields.io/badge/Symfony-6.4%2B-green)](https://symfony.com/)

–ì–æ—Ç–æ–≤—ã–π —à–∞–±–ª–æ–Ω –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞ Symfony-–ø—Ä–æ–µ–∫—Ç–æ–≤ —Å Docker.  
**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:

- ‚ö° Nginx 1.25 + PHP 8.3-FPM + Alpine Linux
- üì¶ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ Symfony —á–µ—Ä–µ–∑ Makefile
- üîß –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Xdebug (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- üîí –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- üê≥ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Redis, MySQL –∏ ClickHouse
- üîÑ –ê–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–¥–∞ –ø—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

## üìã –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

- [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#-–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
- [–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–æ–º](#-—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ-–ø—Ä–æ–µ–∫—Ç–æ–º)
- [Makefile –∫–æ–º–∞–Ω–¥—ã](#-makefile-–∫–æ–º–∞–Ω–¥—ã)
- [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](#-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
- [FAQ](#-faq)
- [–õ–∏—Ü–µ–Ω–∑–∏—è](#-–ª–∏—Ü–µ–Ω–∑–∏—è)

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**:
    ```bash
    git clone https://github.com/csitrovsky/symfony-nginx-php8-stack.git
    cd symfony-nginx-php8-stack
    ```

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ**:
    ```bash
    make env-set
    nano .env  # –†–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
               # PROJECT_PORT, PROJECT_CAAS, PROJECT_PATH
    ```

3. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞**:
    ```bash
    make build        # –°–±–æ—Ä–∫–∞ Docker-–æ–±—Ä–∞–∑–æ–≤
    make app-install  # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Symfony + Webapp Bundle
    ```

4. **–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ**:
    - –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: http://localhost:8888
    - PHP-FPM Status: http://localhost:8888/fpm-status

## üõ† –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–æ–º

```bash
# –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫
make build        # –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤
make up           # –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
make stop         # –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

# –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º
make app-install  # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Symfony
make app-update   # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
make app-clean    # –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞

# –û—Ç–ª–∞–¥–∫–∞
make ssh          # –í–æ–π—Ç–∏ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
```

## üõ† Makefile –∫–æ–º–∞–Ω–¥—ã

–ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥ –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –≤—ã–ø–æ–ª–Ω–∏–≤:

```bash
make help
```

–û—Å–Ω–æ–≤–Ω—ã–µ —Ü–µ–ª–∏:

```
env            ## –ü–æ–∫–∞–∑ —Ç–µ–∫—É—â–∏—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
env-set        ## –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫

build          ## –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤
up             ## –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
stop           ## –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

app-install    ## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Symfony
app-update     ## –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

ssh            ## –í—Ö–æ–¥ –≤ —Å–µ—Ä–≤–∏—Å
```

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (.env)

```ini
# =======================================================
# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å—Ä–µ–¥—Å—Ç–≤–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
# =======================================================
# –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å Docker (sudo, –µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è)
DOCKER_USER = "sudo"

# =======================================================
# –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Å–µ—Ä–≤–∏—Å–∞
# =======================================================
# –û—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
PROJECT_TITLE = "My Awesome Project"
# –ö—Ä–∞—Ç–∫–∏–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞ (3-5 –±—É–∫–≤)
PROJECT_ABBR = "app"

# =======================================================
# –ö—Ä–∞—Ç–∫–∏–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞
# =======================================================
# –ü—Ä–∏–≤—è–∑–∫–∞ –∫ —Ö–æ—Å—Ç—É (127.0.0.1 –∏–ª–∏ localhost)
PROJECT_HOST = "127.0.0.1"
# –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤ (80-8888)
PROJECT_PORT = "8080"
# –ò–º—è —Å–µ—Ä–≤–∏—Å–∞ (—Å—Ç—Ä–æ—á–Ω—ã–µ –±—É–∫–≤—ã —Å–æ –∑–Ω–∞–∫–∞–º–∏ –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏—è)
PROJECT_CAAS = "symfony_app"
# –ü—É—Ç—å –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ (–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞)
PROJECT_PATH = "app"
```

### –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

- `docker-compose.yml` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤
- `.docker/nginx/` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞
- `.docker/php/` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è PHP-FPM

### –ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–ü—Ä–∏–º–µ—Ä –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ `docker-compose.yml`:

```yaml
services:
    db:
        container_name: ${PROJECT_CAAS}-MySQL
        command: --default-authentication-plugin=mysql_native_password --explicit_defaults_for_timestamp=1
        environment:
            MYSQL_ROOT_PASSWORD: ${MYSQL_ROOT_PASSWORD}
            MYSQL_DATABASE: ${MYSQL_DATABASE}
            MYSQL_USER: ${MYSQL_USER}
            MYSQL_PASSWORD: ${MYSQL_PASSWORD}
            MYSQL_ROOT_HOST: ${MYSQL_ROOT_HOST}
        expose:
            - ${MYSQL_HOST_PORT}
        image: mysql/mysql-server:${MYSQL_VERSION}
        networks:
            - default
            - database
        platform: linux/amd64
        restart: always
        tty: true
        ports:
            - ${MYSQL_HOST_PORT}:3306
```

## üóÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
‚îú‚îÄ‚îÄ .docker/
‚îÇ   ‚îú‚îÄ‚îÄ nginx/             # –ö–æ–Ω—Ñ–∏–≥–∏ Nginx
‚îÇ   ‚îú‚îÄ‚îÄ php/               # –ö–æ–Ω—Ñ–∏–≥–∏ PHP-FPM
‚îÇ   ‚îú‚îÄ‚îÄ docker-compose.yml # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Docker
‚îú‚îÄ‚îÄ app/                   # –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥
‚îú‚îÄ‚îÄ .env.example           # –®–∞–±–ª–æ–Ω –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îî‚îÄ‚îÄ Makefile               # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–æ–º
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç –æ—Ç –Ω–µ–ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- –ó–∞—â–∏—Ç–∞ –æ—Ç XSS –∏ CSRF –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

## ‚ùì FAQ

**Q: –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å?**  
A: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:

```bash
make ssh
composer require package-name
```

**Q: –ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å HTTPS?**  
A: –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ SSL-—Å–µ–∫—Ü–∏—é –≤ `nginx.conf` –∏ –¥–æ–±–∞–≤—å—Ç–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã.

## üìú –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License. –ü–æ–¥—Ä–æ–±–Ω–µ–µ –≤ [LICENSE](LICENSE).